{"version":3,"sources":["../../js/map.js"],"names":["$selectExclude","$selectPokemonNotify","$selectRarityNotify","$selectStyle","$selectIconResolution","$selectIconSize","$selectLuredPokestopsOnly","$selectSearchIconMarker","$selectLocationIconMarker","language","document","documentElement","lang","idToPokemon","i8lnDictionary","languageLookups","languageLookupThreshold","searchMarkerStyles","excludedPokemon","notifiedPokemon","notifiedRarity","moves","map","rawDataIsLoading","locationMarker","rangeMarkers","searchMarker","storeZoom","scanPath","selectedStyle","gymTypes","audio","Audio","excludePokemon","id","val","concat","trigger","notifyAboutPokemon","removePokemonMarker","encounterId","mapData","pokemons","marker","rangeCircle","setMap","hidden","initMap","google","maps","Map","getElementById","center","lat","centerLat","lng","centerLng","zoom","Store","get","fullscreenControl","streetViewControl","mapTypeControl","clickableIcons","mapTypeControlOptions","style","MapTypeControlStyle","DROPDOWN_MENU","position","ControlPosition","RIGHT_TOP","mapTypeIds","MapTypeId","ROADMAP","SATELLITE","HYBRID","styleNoLabels","StyledMapType","noLabelsStyle","name","mapTypes","set","styleDark","darkStyle","styleLight2","light2Style","stylePgo","pGoStyle","styleDarkNl","darkStyleNoLabels","styleLight2Nl","light2StyleNoLabels","stylePgoNl","pGoStyleNoLabels","addListener","s","mapTypeId","setMapTypeId","updateMap","getZoom","redrawPokemon","lurePokemons","createSearchMarker","createLocationMarker","createMyLocationButton","initSidebar","updateLocationMarker","setIcon","icon","Marker","animation","Animation","DROP","draggable","optimized","zIndex","MAX_ZINDEX","infoWindow","InfoWindow","content","disableAutoPan","addListeners","event","newLocation","getPosition","updateSearchMarker","oldLocation","changeSearchLocation","done","fail","setPosition","searchControlURI","searchControl","action","$","post","encodeURIComponent","updateSearchStatus","getJSON","then","data","prop","status","toggle","searchBox","places","SearchBox","css","setInterval","getPlaces","length","loc","geometry","location","changeLocation","icons","each","pokemonSprites","key","value","append","attr","text","pad","number","slice","getTypeSpan","type","openMapDirections","myLocation","url","window","open","pokemonLabel","rarity","types","disappearTime","latitude","longitude","ivAttack","ivDefense","ivStamina","move1","move2","disappearDate","Date","rarityDisplay","typesDisplay","index","console","log","ivstring","perfect","toFixed","moveString","contentstring","getHours","getMinutes","getSeconds","gymLabel","teamName","teamId","gymPoints","lastScanned","members","memberStr","i","pokemon_name","trainer_name","trainer_level","pokemon_id","pokemon_cp","lastScannedStr","lastScannedDate","getFullYear","getMonth","getDate","nameStr","gymColor","str","gymPrestige","gymLevel","pokestopLabel","expireTime","expireDate","formatSpawnTime","seconds","Math","floor","substr","spawnpointLabel","item","time","special","addRangeCircle","targetmap","circleCenter","LatLng","gymColors","teamColor","range","circleColor","rangeCircleOpts","radius","strokeWeight","strokeColor","strokeOpacity","fillColor","fillOpacity","Circle","isRangeActive","customizePokemonMarker","skipNotification","setAnimation","animationDisabled","indexOf","play","sendNotification","BOUNCE","perfection","notifiedMinPerfection","setupGymMarker","updateGymMarker","setContent","setupPokestopMarker","imagename","getColorByDate","diff","now","hue","toString","join","setupScannedMarker","clickable","getColorBySpawnTime","round","changeSpawnIcon","color","urlColor","zoomScale","minimumSize","newSize","newIcon","scaledSize","Size","anchor","Point","spawnPointIndex","newIndex","scale","setupSpawnpointMarker","clearSelection","selection","empty","getSelection","removeAllRanges","updateLabelDiffTime","persist","close","clearStaleMarkers","getTime","scanned","showInBoundsMarkers","markers","show","getBounds","intersects","contains","team_id","getMap","oldAnimation","getAnimation","loadRawData","loadPokemon","loadGyms","loadPokestops","loadScanned","loadSpawnpoints","bounds","swPoint","getSouthWest","nePoint","getNorthEast","swLat","swLng","neLat","neLng","ajax","dataType","cache","beforeSend","complete","processPokemons","setupPokemonMarker","processPokestops","pokestops","item2","processGyms","gyms","processScanned","scanId","setOptions","processSpawnpoints","spawnpoints","setZIndex","result","hasClass","countMarkers","drawScanPath","points","scanPathPoints","idx","point","push","Polyline","path","geodesic","pokemonList","newMarker","element","disappearsAt","parseInt","getAttribute","difference","abs","hours","minutes","timestring","getPointDistance","pointA","pointB","spherical","computeDistanceBetween","title","Notification","permission","requestPermission","notification","body","sound","onclick","focus","centerMap","locationContainer","createElement","locationButton","backgroundColor","border","outline","width","height","borderRadius","boxShadow","cursor","marginRight","padding","appendChild","locationIcon","margin","backgroundImage","backgroundSize","backgroundPosition","backgroundRepeat","addEventListener","centerMapOnLocation","controls","RIGHT_BOTTOM","currentLocation","imgX","animationInterval","navigator","geolocation","getCurrentPosition","latlng","coords","setCenter","clearInterval","setZoom","i8ln","word","isEmptyObject","async","success","error","jqXHR","styleList","select2","placeholder","minimumResultsForSearch","Infinity","on","e","searchMarkerStyleList","selectSearchIconMarker","formatState","state","$state","numberOfPokemon","pokeList","_types","pokemonType","templateResult","Number","String","isTouchDevice","panTo","buildSwitchChangeListener","storageKey","checked","d","dType","change","options","wrapper","hide","bind","setDraggable","accordion","active","collapsible","heightStyle"],"mappings":"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","file":"map.built.js","sourcesContent":["//\r\n// Global map.js variables\r\n//\r\n\r\nvar $selectExclude\r\nvar $selectPokemonNotify\r\nvar $selectRarityNotify\r\nvar $selectStyle\r\nvar $selectIconResolution\r\nvar $selectIconSize\r\nvar $selectLuredPokestopsOnly\r\nvar $selectSearchIconMarker\r\nvar $selectLocationIconMarker\r\n\r\nvar language = document.documentElement.lang === '' ? 'en' : document.documentElement.lang\r\nvar idToPokemon = {}\r\nvar i8lnDictionary = {}\r\nvar languageLookups = 0\r\nvar languageLookupThreshold = 3\r\n\r\nvar searchMarkerStyles\r\n\r\nvar excludedPokemon = []\r\nvar notifiedPokemon = []\r\nvar notifiedRarity = []\r\n\r\nvar moves\r\nvar map\r\nvar rawDataIsLoading = false\r\nvar locationMarker\r\nvar rangeMarkers = ['pokemon', 'pokestop', 'gym']\r\nvar searchMarker\r\nvar storeZoom = true\r\nvar scanPath\r\n\r\n\r\nvar selectedStyle = 'light'\r\n\r\n\r\nvar gymTypes = ['Uncontested', 'Mystic', 'Valor', 'Instinct']\r\nvar audio = new Audio('static/sounds/ding.mp3')\r\n\r\n//\r\n// Functions\r\n//\r\n\r\nfunction excludePokemon (id) { // eslint-disable-line no-unused-vars\r\n  $selectExclude.val(\r\n    $selectExclude.val().concat(id)\r\n  ).trigger('change')\r\n}\r\n\r\nfunction notifyAboutPokemon (id) { // eslint-disable-line no-unused-vars\r\n  $selectPokemonNotify.val(\r\n    $selectPokemonNotify.val().concat(id)\r\n  ).trigger('change')\r\n}\r\n\r\nfunction removePokemonMarker (encounterId) { // eslint-disable-line no-unused-vars\r\n  if (mapData.pokemons[encounterId].marker.rangeCircle) {\r\n    mapData.pokemons[encounterId].marker.rangeCircle.setMap(null)\r\n    delete mapData.pokemons[encounterId].marker.rangeCircle\r\n  }\r\n  mapData.pokemons[encounterId].marker.setMap(null)\r\n  mapData.pokemons[encounterId].hidden = true\r\n}\r\n\r\nfunction initMap () { // eslint-disable-line no-unused-vars\r\n  map = new google.maps.Map(document.getElementById('map'), {\r\n    center: {\r\n      lat: centerLat,\r\n      lng: centerLng\r\n    },\r\n    zoom: Store.get('zoomLevel'),\r\n    fullscreenControl: true,\r\n    streetViewControl: false,\r\n    mapTypeControl: false,\r\n    clickableIcons: false,\r\n    mapTypeControlOptions: {\r\n      style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,\r\n      position: google.maps.ControlPosition.RIGHT_TOP,\r\n      mapTypeIds: [\r\n        google.maps.MapTypeId.ROADMAP,\r\n        google.maps.MapTypeId.SATELLITE,\r\n        google.maps.MapTypeId.HYBRID,\r\n        'nolabels_style',\r\n        'dark_style',\r\n        'style_light2',\r\n        'style_pgo',\r\n        'dark_style_nl',\r\n        'style_light2_nl',\r\n        'style_pgo_nl'\r\n      ]\r\n    }\r\n  })\r\n\r\n  var styleNoLabels = new google.maps.StyledMapType(noLabelsStyle, {\r\n    name: 'No Labels'\r\n  })\r\n  map.mapTypes.set('nolabels_style', styleNoLabels)\r\n\r\n  var styleDark = new google.maps.StyledMapType(darkStyle, {\r\n    name: 'Dark'\r\n  })\r\n  map.mapTypes.set('dark_style', styleDark)\r\n\r\n  var styleLight2 = new google.maps.StyledMapType(light2Style, {\r\n    name: 'Light2'\r\n  })\r\n  map.mapTypes.set('style_light2', styleLight2)\r\n\r\n  var stylePgo = new google.maps.StyledMapType(pGoStyle, {\r\n    name: 'PokemonGo'\r\n  })\r\n  map.mapTypes.set('style_pgo', stylePgo)\r\n\r\n  var styleDarkNl = new google.maps.StyledMapType(darkStyleNoLabels, {\r\n    name: 'Dark (No Labels)'\r\n  })\r\n  map.mapTypes.set('dark_style_nl', styleDarkNl)\r\n\r\n  var styleLight2Nl = new google.maps.StyledMapType(light2StyleNoLabels, {\r\n    name: 'Light2 (No Labels)'\r\n  })\r\n  map.mapTypes.set('style_light2_nl', styleLight2Nl)\r\n\r\n  var stylePgoNl = new google.maps.StyledMapType(pGoStyleNoLabels, {\r\n    name: 'PokemonGo (No Labels)'\r\n  })\r\n  map.mapTypes.set('style_pgo_nl', stylePgoNl)\r\n\r\n  map.addListener('maptypeid_changed', function (s) {\r\n    Store.set('map_style', this.mapTypeId)\r\n  })\r\n\r\n  map.setMapTypeId(Store.get('map_style'))\r\n  map.addListener('idle', updateMap)\r\n\r\n  map.addListener('zoom_changed', function () {\r\n    if (storeZoom === true) {\r\n      Store.set('zoomLevel', this.getZoom())\r\n    } else {\r\n      storeZoom = true\r\n    }\r\n\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  searchMarker = createSearchMarker()\r\n  locationMarker = createLocationMarker()\r\n  createMyLocationButton()\r\n  initSidebar()\r\n}\r\n\r\nfunction updateLocationMarker (style) {\r\n  if (style in searchMarkerStyles) {\r\n    locationMarker.setIcon(searchMarkerStyles[style].icon)\r\n    Store.set('locationMarkerStyle', style)\r\n  }\r\n  return locationMarker\r\n}\r\n\r\nfunction createLocationMarker () {\r\n  var position = Store.get('followMyLocationPosition')\r\n  var lat = ('lat' in position) ? position.lat : centerLat\r\n  var lng = ('lng' in position) ? position.lng : centerLng\r\n\r\n  var locationMarker = new google.maps.Marker({\r\n    map: map,\r\n    animation: google.maps.Animation.DROP,\r\n    position: {\r\n      lat: lat,\r\n      lng: lng\r\n    },\r\n    draggable: true,\r\n    icon: null,\r\n    optimized: false,\r\n    zIndex: google.maps.Marker.MAX_ZINDEX + 2\r\n  })\r\n\r\n  locationMarker.infoWindow = new google.maps.InfoWindow({\r\n    content: '<div><b>My Location</b></div>',\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(locationMarker)\r\n\r\n  google.maps.event.addListener(locationMarker, 'dragend', function () {\r\n    var newLocation = locationMarker.getPosition()\r\n    Store.set('followMyLocationPosition', { lat: newLocation.lat(), lng: newLocation.lng() })\r\n  })\r\n\r\n  return locationMarker\r\n}\r\n\r\nfunction updateSearchMarker (style) {\r\n  if (style in searchMarkerStyles) {\r\n    searchMarker.setIcon(searchMarkerStyles[style].icon)\r\n    Store.set('searchMarkerStyle', style)\r\n  }\r\n\r\n  return searchMarker\r\n}\r\n\r\nfunction createSearchMarker () {\r\n  var searchMarker = new google.maps.Marker({ // need to keep reference.\r\n    position: {\r\n      lat: centerLat,\r\n      lng: centerLng\r\n    },\r\n    map: map,\r\n    animation: google.maps.Animation.DROP,\r\n    draggable: !Store.get('lockMarker'),\r\n    icon: null,\r\n    optimized: false,\r\n    zIndex: google.maps.Marker.MAX_ZINDEX + 1\r\n  })\r\n\r\n  searchMarker.infoWindow = new google.maps.InfoWindow({\r\n    content: '<div><b>Search Location</b></div>',\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(searchMarker)\r\n\r\n  var oldLocation = null\r\n  google.maps.event.addListener(searchMarker, 'dragstart', function () {\r\n    oldLocation = searchMarker.getPosition()\r\n  })\r\n\r\n  google.maps.event.addListener(searchMarker, 'dragend', function () {\r\n    var newLocation = searchMarker.getPosition()\r\n    changeSearchLocation(newLocation.lat(), newLocation.lng())\r\n      .done(function () {\r\n        oldLocation = null\r\n      })\r\n      .fail(function () {\r\n        if (oldLocation) {\r\n          searchMarker.setPosition(oldLocation)\r\n        }\r\n      })\r\n  })\r\n\r\n  return searchMarker\r\n}\r\n\r\nvar searchControlURI = 'search_control'\r\nfunction searchControl (action) {\r\n  $.post(searchControlURI + '?action=' + encodeURIComponent(action))\r\n}\r\nfunction updateSearchStatus () {\r\n  $.getJSON(searchControlURI).then(function (data) {\r\n    $('#search-switch').prop('checked', data.status)\r\n  })\r\n}\r\n\r\nfunction initSidebar () {\r\n  $('#gyms-switch').prop('checked', Store.get('showGyms'))\r\n  $('#pokemon-switch').prop('checked', Store.get('showPokemon'))\r\n  $('#pokestops-switch').prop('checked', Store.get('showPokestops'))\r\n  $('#lured-pokestops-only-switch').val(Store.get('showLuredPokestopsOnly'))\r\n  $('#lured-pokestops-only-wrapper').toggle(Store.get('showPokestops'))\r\n  $('#geoloc-switch').prop('checked', Store.get('geoLocate'))\r\n  $('#lock-marker-switch').prop('checked', Store.get('lockMarker'))\r\n  $('#start-at-user-location-switch').prop('checked', Store.get('startAtUserLocation'))\r\n  $('#follow-my-location-switch').prop('checked', Store.get('followMyLocation'))\r\n  $('#scanned-switch').prop('checked', Store.get('showScanned'))\r\n  $('#spawnpoints-switch').prop('checked', Store.get('showSpawnpoints'))\r\n  $('#ranges-switch').prop('checked', Store.get('showRanges'))\r\n  $('#sound-switch').prop('checked', Store.get('playSound'))\r\n  var searchBox = new google.maps.places.SearchBox(document.getElementById('next-location'))\r\n  $('#next-location').css('background-color', $('#geoloc-switch').prop('checked') ? '#e0e0e0' : '#ffffff')\r\n\r\n  updateSearchStatus()\r\n  setInterval(updateSearchStatus, 5000)\r\n\r\n  searchBox.addListener('places_changed', function () {\r\n    var places = searchBox.getPlaces()\r\n\r\n    if (places.length === 0) {\r\n      return\r\n    }\r\n\r\n    var loc = places[0].geometry.location\r\n    changeLocation(loc.lat(), loc.lng())\r\n  })\r\n\r\n  var icons = $('#pokemon-icons')\r\n  $.each(pokemonSprites, function (key, value) {\r\n    icons.append($('<option></option>').attr('value', key).text(value.name))\r\n  })\r\n  icons.val((pokemonSprites[Store.get('pokemonIcons')]) ? Store.get('pokemonIcons') : 'highres')\r\n  $('#pokemon-icon-size').val(Store.get('iconSizeModifier'))\r\n}\r\n\r\nfunction pad (number) {\r\n  return number <= 99 ? ('0' + number).slice(-2) : number\r\n}\r\n\r\nfunction getTypeSpan (type) {\r\n  return `<span style='padding: 2px 5px; text-transform: uppercase; color: white; margin-right: 2px; border-radius: 4px; font-size: 0.8em; vertical-align: text-bottom; background-color: ${type['color']}'>${type['type']}</span>`\r\n}\r\n\r\nfunction openMapDirections (lat, lng) { // eslint-disable-line no-unused-vars\r\n  var myLocation = locationMarker.getPosition()\r\n  var url = 'https://www.google.com/maps/dir/' + myLocation.lat() + ',' + myLocation.lng() + '/' + lat + ',' + lng\r\n  window.open(url, '_blank')\r\n}\r\n\r\nfunction pokemonLabel (name, rarity, types, disappearTime, id, latitude, longitude, encounterId, ivAttack, ivDefense, ivStamina, move1, move2) {\r\n  var disappearDate = new Date(disappearTime)\r\n  var rarityDisplay = rarity ? '(' + rarity + ')' : ''\r\n  var typesDisplay = ''\r\n  $.each(types, function (index, type) {\r\n    typesDisplay += getTypeSpan(type)\r\n  })\r\n\r\n  console.log(ivAttack);\r\n\r\n  var ivstring = ''\r\n  if (ivAttack != null) {\r\n    var perfect = ((ivAttack + ivDefense + ivStamina) / 45 * 100).toFixed(1) + '%'\r\n    ivstring = `\r\n      <div>\r\n        Attack: ${ivAttack}, Defense: ${ivDefense}, Stamina: ${ivStamina}, Perfection: ${perfect}\r\n      </div>`\r\n  }\r\n\r\n  var moveString = ''\r\n  if (move1 != null){\r\n    moveString = `\r\n      <div>\r\n        Move 1: ${moves[move1]}, Move 2: ${moves[move2]}\r\n      </div>\r\n    `\r\n  }\r\n\r\n  var contentstring = `\r\n    <div>\r\n      <b>${name}</b>\r\n      <span> - </span>\r\n      <small>\r\n        <a href='http://www.pokemon.com/us/pokedex/${id}' target='_blank' title='View in Pokedex'>#${id}</a>\r\n      </small>\r\n      <span> ${rarityDisplay}</span>\r\n      <span> - </span>\r\n      <small>${typesDisplay}</small>\r\n    </div>\r\n    ${ivstring}\r\n    ${moveString}\r\n    <div>\r\n      Disappears at ${pad(disappearDate.getHours())}:${pad(disappearDate.getMinutes())}:${pad(disappearDate.getSeconds())}\r\n      <span class='label-countdown' disappears-at='${disappearTime}'>(00m00s)</span>\r\n    </div>\r\n    <div>\r\n      Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n    </div>\r\n    <div>\r\n      <a href='javascript:excludePokemon(${id})'>Exclude</a>&nbsp;&nbsp\r\n      <a href='javascript:notifyAboutPokemon(${id})'>Notify</a>&nbsp;&nbsp\r\n      <a href='javascript:removePokemonMarker(\"${encounterId}\")'>Remove</a>&nbsp;&nbsp\r\n      <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\r\n    </div>`\r\n  return contentstring\r\n}\r\n\r\nfunction gymLabel (teamName, teamId, gymPoints, latitude, longitude, lastScanned = null, name = null, members = []) {\r\n  var memberStr = ''\r\n  for (var i = 0; i < members.length; i++) {\r\n    memberStr += `\r\n      <span class=\"gym-member\" title=\"${members[i].pokemon_name} | ${members[i].trainer_name} (Lvl ${members[i].trainer_level})\">\r\n        <i class=\"pokemon-sprite n${members[i].pokemon_id}\"></i>\r\n        <span class=\"cp team-${teamId}\">${members[i].pokemon_cp}</span>\r\n      </span>`\r\n  }\r\n\r\n  var lastScannedStr\r\n  if (lastScanned) {\r\n    var lastScannedDate = new Date(lastScanned)\r\n    lastScannedStr = `${lastScannedDate.getFullYear()}-${pad(lastScannedDate.getMonth() + 1)}-${pad(lastScannedDate.getDate())} ${pad(lastScannedDate.getHours())}:${pad(lastScannedDate.getMinutes())}:${pad(lastScannedDate.getSeconds())}`\r\n  } else {\r\n    lastScannedStr = 'Unknown'\r\n  }\r\n\r\n  var nameStr = (name ? `<div>${name}</div>` : '')\r\n\r\n  var gymColor = ['0, 0, 0, .4', '74, 138, 202, .6', '240, 68, 58, .6', '254, 217, 40, .6']\r\n  var str\r\n  if (teamId === 0) {\r\n    str = `\r\n      <div>\r\n        <center>\r\n          <div>\r\n            <b style='color:rgba(${gymColor[teamId]})'>${teamName}</b><br>\r\n            <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\r\n          </div>\r\n          ${nameStr}\r\n          <div>\r\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n          </div>\r\n          <div>\r\n            Last Scanned: ${lastScannedStr}\r\n          </div>\r\n          <div>\r\n            <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\r\n          </div>\r\n        </center>\r\n      </div>`\r\n  } else {\r\n    var gymPrestige = [2000, 4000, 8000, 12000, 16000, 20000, 30000, 40000, 50000]\r\n    var gymLevel = 1\r\n    while (gymPoints >= gymPrestige[gymLevel - 1]) {\r\n      gymLevel++\r\n    }\r\n    str = `\r\n      <div>\r\n        <center>\r\n          <div style='padding-bottom: 2px'>\r\n            Gym owned by:\r\n          </div>\r\n          <div>\r\n            <b style='color:rgba(${gymColor[teamId]})'>Team ${teamName}</b><br>\r\n            <img height='70px' style='padding: 5px;' src='static/forts/${teamName}_large.png'>\r\n          </div>\r\n          <div>\r\n            ${nameStr}\r\n          </div>\r\n          <div>\r\n            Level: ${gymLevel} | Prestige: ${gymPoints}/${gymPrestige[gymLevel - 1] || 50000}\r\n          </div>\r\n          <div>\r\n            ${memberStr}\r\n          </div>\r\n          <div>\r\n            Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n          </div>\r\n          <div>\r\n            Last Scanned: ${lastScannedStr}\r\n          </div>\r\n          <div>\r\n            <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\r\n          </div>\r\n        </center>\r\n      </div>`\r\n  }\r\n\r\n  return str\r\n}\r\n\r\nfunction pokestopLabel (expireTime, latitude, longitude) {\r\n  var str\r\n  if (expireTime) {\r\n    var expireDate = new Date(expireTime)\r\n\r\n    str = `\r\n      <div>\r\n        <b>Lured Pokéstop</b>\r\n      </div>\r\n      <div>\r\n        Lure expires at ${pad(expireDate.getHours())}:${pad(expireDate.getMinutes())}:${pad(expireDate.getSeconds())}\r\n        <span class='label-countdown' disappears-at='${expireTime}'>(00m00s)</span>\r\n      </div>\r\n      <div>\r\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n      </div>\r\n      <div>\r\n        <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\r\n      </div>`\r\n  } else {\r\n    str = `\r\n      <div>\r\n        <b>Pokéstop</b>\r\n      </div>\r\n      <div>\r\n        Location: ${latitude.toFixed(6)}, ${longitude.toFixed(7)}\r\n      </div>\r\n      <div>\r\n        <a href='javascript:void(0);' onclick='javascript:openMapDirections(${latitude},${longitude});' title='View in Maps'>Get directions</a>\r\n      </div>`\r\n  }\r\n\r\n  return str\r\n}\r\n\r\nfunction formatSpawnTime (seconds) {\r\n  // the addition and modulo are required here because the db stores when a spawn disappears\r\n  // the subtraction to get the appearance time will knock seconds under 0 if the spawn happens in the previous hour\r\n  return ('0' + Math.floor(((seconds + 3600) % 3600) / 60)).substr(-2) + ':' + ('0' + seconds % 60).substr(-2)\r\n}\r\nfunction spawnpointLabel (item) {\r\n  var str = `\r\n    <div>\r\n      <b>Spawn Point</b>\r\n    </div>\r\n    <div>\r\n      Every hour from ${formatSpawnTime(item.time)} to ${formatSpawnTime(item.time + 900)}\r\n    </div>`\r\n\r\n  if (item.special) {\r\n    str += `\r\n      <div>\r\n        May appear as early as ${formatSpawnTime(item.time - 1800)}\r\n      </div>`\r\n  }\r\n  return str\r\n}\r\n\r\nfunction addRangeCircle (marker, map, type, teamId) {\r\n  var targetmap = null\r\n  var circleCenter = new google.maps.LatLng(marker.position.lat(), marker.position.lng())\r\n  var gymColors = ['#999999', '#0051CF', '#FF260E', '#FECC23'] // 'Uncontested', 'Mystic', 'Valor', 'Instinct']\r\n  var teamColor = gymColors[0]\r\n  if (teamId) teamColor = gymColors[teamId]\r\n\r\n  var range\r\n  var circleColor\r\n\r\n  // handle each type of marker and be explicit about the range circle attributes\r\n  switch (type) {\r\n    case 'pokemon':\r\n      circleColor = '#C233F2'\r\n      range = 40 // pokemon appear at 40m and then you can move away. still have to be 40m close to see it though, so ignore the further disappear distance\r\n      break\r\n    case 'pokestop':\r\n      circleColor = '#3EB0FF'\r\n      range = 40\r\n      break\r\n    case 'gym':\r\n      circleColor = teamColor\r\n      range = 40\r\n      break\r\n  }\r\n\r\n  if (map) targetmap = map\r\n\r\n  var rangeCircleOpts = {\r\n    map: targetmap,\r\n    radius: range, // meters\r\n    strokeWeight: 1,\r\n    strokeColor: circleColor,\r\n    strokeOpacity: 0.9,\r\n    center: circleCenter,\r\n    fillColor: circleColor,\r\n    fillOpacity: 0.3\r\n  }\r\n  var rangeCircle = new google.maps.Circle(rangeCircleOpts)\r\n  return rangeCircle\r\n}\r\n\r\nfunction isRangeActive (map) {\r\n  if (map.getZoom() < 16) return false\r\n  return Store.get('showRanges')\r\n}\r\n\r\nfunction customizePokemonMarker (marker, item, skipNotification) {\r\n  marker.addListener('click', function () {\r\n    this.setAnimation(null)\r\n    this.animationDisabled = true\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokemon')\r\n  }\r\n\r\n  console.log(item);\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: pokemonLabel(item['pokemon_name'], item['pokemon_rarity'], item['pokemon_types'], item['disappear_time'], item['pokemon_id'], item['latitude'], item['longitude'], item['encounter_id'], item['iv_attack'], item['iv_defense'], item['iv_stamina'], item['move_1'], item['move_2']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  if (notifiedPokemon.indexOf(item['pokemon_id']) > -1 || notifiedRarity.indexOf(item['pokemon_rarity']) > -1) {\r\n    if (!skipNotification) {\r\n      if (Store.get('playSound')) {\r\n        audio.play()\r\n      }\r\n      sendNotification('A wild ' + item['pokemon_name'] + ' appeared!', 'Click to load map', 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\r\n    }\r\n    if (marker.animationDisabled !== true) {\r\n      marker.setAnimation(google.maps.Animation.BOUNCE)\r\n    }\r\n    if (item['iv_attack'] != null) {\r\n      var perfection = 100.0 * (item['iv_attack'] + item['iv_defense'] + item['iv_stamina']) / 45\r\n      if (notifiedMinPerfection > 0 && perfection >= notifiedMinPerfection) {\r\n        if (!skipNotification) {\r\n          if (Store.get('playSound')) {\r\n            audio.play()\r\n          }\r\n          sendNotification('A ' + perfection.toFixed(1) + '% perfect ' + item['pokemon_name'] + ' appeared!', 'Click to load map', 'static/icons/' + item['pokemon_id'] + '.png', item['latitude'], item['longitude'])\r\n        }\r\n        if (marker.animationDisabled !== true) {\r\n         marker.setAnimation(google.maps.Animation.BOUNCE)\r\n        }\r\n    }\r\n  }\r\n  }\r\n\r\n  addListeners(marker)\r\n}\r\n\r\nfunction setupGymMarker (item) {\r\n  var marker = new google.maps.Marker({\r\n    position: {\r\n      lat: item['latitude'],\r\n      lng: item['longitude']\r\n    },\r\n    map: map,\r\n    icon: 'static/forts/' + gymTypes[item['team_id']] + '.png'\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'gym', item['team_id'])\r\n  }\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(marker)\r\n  return marker\r\n}\r\n\r\nfunction updateGymMarker (item, marker) {\r\n  marker.setIcon('static/forts/' + gymTypes[item['team_id']] + '.png')\r\n  marker.infoWindow.setContent(gymLabel(gymTypes[item['team_id']], item['team_id'], item['gym_points'], item['latitude'], item['longitude'], item['last_scanned'], item['name'], item['pokemon']))\r\n  return marker\r\n}\r\n\r\nfunction setupPokestopMarker (item) {\r\n  var imagename = item['lure_expiration'] ? 'PstopLured' : 'Pstop'\r\n  var marker = new google.maps.Marker({\r\n    position: {\r\n      lat: item['latitude'],\r\n      lng: item['longitude']\r\n    },\r\n    map: map,\r\n    zIndex: 2,\r\n    icon: 'static/forts/' + imagename + '.png'\r\n  })\r\n\r\n  if (!marker.rangeCircle && isRangeActive(map)) {\r\n    marker.rangeCircle = addRangeCircle(marker, map, 'pokestop')\r\n  }\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: pokestopLabel(item['lure_expiration'], item['latitude'], item['longitude']),\r\n    disableAutoPan: true\r\n  })\r\n\r\n  addListeners(marker)\r\n  return marker\r\n}\r\n\r\nfunction getColorByDate (value) {\r\n  // Changes the color from red to green over 15 mins\r\n  var diff = (Date.now() - value) / 1000 / 60 / 15\r\n\r\n  if (diff > 1) {\r\n    diff = 1\r\n  }\r\n\r\n  // value from 0 to 1 - Green to Red\r\n  var hue = ((1 - diff) * 120).toString(10)\r\n  return ['hsl(', hue, ',100%,50%)'].join('')\r\n}\r\n\r\nfunction setupScannedMarker (item) {\r\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\r\n\r\n  var marker = new google.maps.Circle({\r\n    map: map,\r\n    clickable: false,\r\n    center: circleCenter,\r\n    radius: 70, // metres\r\n    fillColor: getColorByDate(item['last_modified']),\r\n    fillOpacity: 0.1,\r\n    strokeWeight: 1,\r\n    strokeOpacity: 0.5\r\n  })\r\n\r\n  return marker\r\n}\r\n\r\nfunction getColorBySpawnTime (value) {\r\n  var now = new Date()\r\n  var seconds = now.getMinutes() * 60 + now.getSeconds()\r\n\r\n  // account for hour roll-over\r\n  if (seconds < 900 && value > 2700) {\r\n    seconds += 3600\r\n  } else if (seconds > 2700 && value < 900) {\r\n    value += 3600\r\n  }\r\n\r\n  var diff = (seconds - value)\r\n  var hue = 275 // light purple when spawn is neither about to spawn nor active\r\n  if (diff >= 0 && diff <= 900) { // green to red over 15 minutes of active spawn\r\n    hue = (1 - (diff / 60 / 15)) * 120\r\n  } else if (diff < 0 && diff > -300) { // light blue to dark blue over 5 minutes til spawn\r\n    hue = ((1 - (-diff / 60 / 5)) * 50) + 200\r\n  }\r\n\r\n  hue = Math.round(hue / 5) * 5\r\n\r\n  return hue\r\n}\r\n\r\nfunction changeSpawnIcon (color, zoom) {\r\n  var urlColor = ''\r\n  if (color === 275) {\r\n    urlColor = './static/icons/hsl-275-light.png'\r\n  } else {\r\n    urlColor = './static/icons/hsl-' + color + '.png'\r\n  }\r\n  var zoomScale = 1.6 // adjust this value to change the size of the spawnpoint icons\r\n  var minimumSize = 1\r\n  var newSize = Math.round(zoomScale * (zoom - 10)) // this scales the icon based on zoom\r\n  if (newSize < minimumSize) {\r\n    newSize = minimumSize\r\n  }\r\n\r\n  var newIcon = {\r\n    url: urlColor,\r\n    scaledSize: new google.maps.Size(newSize, newSize),\r\n    anchor: new google.maps.Point(newSize / 2, newSize / 2)\r\n  }\r\n\r\n  return newIcon\r\n}\r\n\r\nfunction spawnPointIndex (color) {\r\n  var newIndex = 1\r\n  var scale = 0\r\n  if (color >= 0 && color <= 120) { // high to low over 15 minutes of active spawn\r\n    scale = color / 120\r\n    newIndex = 100 + scale * 100\r\n  } else if (color >= 200 && color <= 250) { // low to high over 5 minutes til spawn\r\n    scale = (color - 200) / 50\r\n    newIndex = scale * 100\r\n  }\r\n\r\n  return newIndex\r\n}\r\n\r\nfunction setupSpawnpointMarker (item) {\r\n  var circleCenter = new google.maps.LatLng(item['latitude'], item['longitude'])\r\n  var hue = getColorBySpawnTime(item.time)\r\n  var zoom = map.getZoom()\r\n\r\n  var marker = new google.maps.Marker({\r\n    map: map,\r\n    position: circleCenter,\r\n    icon: changeSpawnIcon(hue, zoom),\r\n    zIndex: spawnPointIndex(hue)\r\n  })\r\n\r\n  marker.infoWindow = new google.maps.InfoWindow({\r\n    content: spawnpointLabel(item),\r\n    disableAutoPan: true,\r\n    position: circleCenter\r\n  })\r\n\r\n  addListeners(marker)\r\n\r\n  return marker\r\n}\r\n\r\nfunction clearSelection () {\r\n  if (document.selection) {\r\n    document.selection.empty()\r\n  } else if (window.getSelection) {\r\n    window.getSelection().removeAllRanges()\r\n  }\r\n}\r\n\r\nfunction addListeners (marker) {\r\n  marker.addListener('click', function () {\r\n    marker.infoWindow.open(map, marker)\r\n    clearSelection()\r\n    updateLabelDiffTime()\r\n    marker.persist = true\r\n  })\r\n\r\n  google.maps.event.addListener(marker.infoWindow, 'closeclick', function () {\r\n    marker.persist = null\r\n  })\r\n\r\n  marker.addListener('mouseover', function () {\r\n    marker.infoWindow.open(map, marker)\r\n    clearSelection()\r\n    updateLabelDiffTime()\r\n  })\r\n\r\n  marker.addListener('mouseout', function () {\r\n    if (!marker.persist) {\r\n      marker.infoWindow.close()\r\n    }\r\n  })\r\n\r\n  return marker\r\n}\r\n\r\nfunction clearStaleMarkers () {\r\n  $.each(mapData.pokemons, function (key, value) {\r\n    if (mapData.pokemons[key]['disappear_time'] < new Date().getTime() ||\r\n      excludedPokemon.indexOf(mapData.pokemons[key]['pokemon_id']) >= 0) {\r\n      if (mapData.pokemons[key].marker.rangeCircle) {\r\n        mapData.pokemons[key].marker.rangeCircle.setMap(null)\r\n        delete mapData.pokemons[key].marker.rangeCircle\r\n      }\r\n      mapData.pokemons[key].marker.setMap(null)\r\n      delete mapData.pokemons[key]\r\n    }\r\n  })\r\n\r\n  $.each(mapData.lurePokemons, function (key, value) {\r\n    if (mapData.lurePokemons[key]['lure_expiration'] < new Date().getTime() ||\r\n      excludedPokemon.indexOf(mapData.lurePokemons[key]['pokemon_id']) >= 0) {\r\n      mapData.lurePokemons[key].marker.setMap(null)\r\n      delete mapData.lurePokemons[key]\r\n    }\r\n  })\r\n\r\n  $.each(mapData.scanned, function (key, value) {\r\n    // If older than 15mins remove\r\n    if (mapData.scanned[key]['last_modified'] < (new Date().getTime() - 15 * 60 * 1000)) {\r\n      mapData.scanned[key].marker.setMap(null)\r\n      delete mapData.scanned[key]\r\n    }\r\n  })\r\n}\r\n\r\nfunction showInBoundsMarkers (markers, type) {\r\n  $.each(markers, function (key, value) {\r\n    var marker = markers[key].marker\r\n    var show = false\r\n    if (!markers[key].hidden) {\r\n      if (typeof marker.getBounds === 'function') {\r\n        if (map.getBounds().intersects(marker.getBounds())) {\r\n          show = true\r\n        }\r\n      } else if (typeof marker.getPosition === 'function') {\r\n        if (map.getBounds().contains(marker.getPosition())) {\r\n          show = true\r\n        }\r\n      }\r\n    }\r\n    // marker has an associated range\r\n    if (show && rangeMarkers.indexOf(type) !== -1) {\r\n      // no range circle yet...let's create one\r\n      if (!marker.rangeCircle) {\r\n        // but only if range is active\r\n        if (isRangeActive(map)) {\r\n          if (type === 'gym') marker.rangeCircle = addRangeCircle(marker, map, type, markers[key].team_id)\r\n          else marker.rangeCircle = addRangeCircle(marker, map, type)\r\n        }\r\n      } else { // there's already a range circle\r\n        if (isRangeActive(map)) {\r\n          marker.rangeCircle.setMap(map)\r\n        } else {\r\n          marker.rangeCircle.setMap(null)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (show && !marker.getMap()) {\r\n      marker.setMap(map)\r\n      // Not all markers can be animated (ex: scan locations)\r\n      if (marker.setAnimation && marker.oldAnimation) {\r\n        marker.setAnimation(marker.oldAnimation)\r\n      }\r\n    } else if (!show && marker.getMap()) {\r\n      // Not all markers can be animated (ex: scan locations)\r\n      if (marker.getAnimation) {\r\n        marker.oldAnimation = marker.getAnimation()\r\n      }\r\n      if (marker.rangeCircle) marker.rangeCircle.setMap(null)\r\n      marker.setMap(null)\r\n    }\r\n  })\r\n}\r\n\r\nfunction loadRawData () {\r\n  var loadPokemon = Store.get('showPokemon')\r\n  var loadGyms = Store.get('showGyms')\r\n  var loadPokestops = Store.get('showPokestops')\r\n  var loadScanned = Store.get('showScanned')\r\n  var loadSpawnpoints = Store.get('showSpawnpoints')\r\n\r\n  var bounds = map.getBounds()\r\n  var swPoint = bounds.getSouthWest()\r\n  var nePoint = bounds.getNorthEast()\r\n  var swLat = swPoint.lat()\r\n  var swLng = swPoint.lng()\r\n  var neLat = nePoint.lat()\r\n  var neLng = nePoint.lng()\r\n\r\n  return $.ajax({\r\n    url: 'raw_data',\r\n    type: 'GET',\r\n    data: {\r\n      'pokemon': loadPokemon,\r\n      'pokestops': loadPokestops,\r\n      'gyms': loadGyms,\r\n      'scanned': loadScanned,\r\n      'spawnpoints': loadSpawnpoints,\r\n      'swLat': swLat,\r\n      'swLng': swLng,\r\n      'neLat': neLat,\r\n      'neLng': neLng\r\n    },\r\n    dataType: 'json',\r\n    cache: false,\r\n    beforeSend: function () {\r\n      if (rawDataIsLoading) {\r\n        return false\r\n      } else {\r\n        rawDataIsLoading = true\r\n      }\r\n    },\r\n    complete: function () {\r\n      rawDataIsLoading = false\r\n    }\r\n  })\r\n}\r\n\r\nfunction processPokemons (i, item) {\r\n  if (!Store.get('showPokemon')) {\r\n    return false // in case the checkbox was unchecked in the meantime.\r\n  }\r\n\r\n  if (!(item['encounter_id'] in mapData.pokemons) &&\r\n    excludedPokemon.indexOf(item['pokemon_id']) < 0) {\r\n    // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    if (!item.hidden) {\r\n      item.marker = setupPokemonMarker(item, map)\r\n      customizePokemonMarker(item.marker, item)\r\n      mapData.pokemons[item['encounter_id']] = item\r\n    }\r\n  }\r\n}\r\n\r\nfunction processPokestops (i, item) {\r\n  if (!Store.get('showPokestops')) {\r\n    return false\r\n  }\r\n\r\n  if (Store.get('showLuredPokestopsOnly') && !item['lure_expiration']) {\r\n    if (mapData.pokestops[item['pokestop_id']] && mapData.pokestops[item['pokestop_id']].marker) {\r\n      if (mapData.pokestops[item['pokestop_id']].marker.rangeCircle) {\r\n        mapData.pokestops[item['pokestop_id']].marker.rangeCircle.setMap(null)\r\n      }\r\n      mapData.pokestops[item['pokestop_id']].marker.setMap(null)\r\n      delete mapData.pokestops[item['pokestop_id']]\r\n    }\r\n    return true\r\n  }\r\n\r\n  if (!mapData.pokestops[item['pokestop_id']]) { // add marker to map and item to dict\r\n    // add marker to map and item to dict\r\n    if (item.marker && item.marker.rangeCircle) {\r\n      item.marker.rangeCircle.setMap(null)\r\n    }\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupPokestopMarker(item)\r\n    mapData.pokestops[item['pokestop_id']] = item\r\n  } else {\r\n    var item2 = mapData.pokestops[item['pokestop_id']]\r\n    if (!!item['lure_expiration'] !== !!item2['lure_expiration']) {\r\n      if (item2.marker && item2.marker.rangeCircle) {\r\n        item2.marker.rangeCircle.setMap(null)\r\n      }\r\n      item2.marker.setMap(null)\r\n      item.marker = setupPokestopMarker(item)\r\n      mapData.pokestops[item['pokestop_id']] = item\r\n    }\r\n  }\r\n}\r\n\r\nfunction processGyms (i, item) {\r\n  if (!Store.get('showGyms')) {\r\n    return false // in case the checkbox was unchecked in the meantime.\r\n  }\r\n\r\n  if (item['gym_id'] in mapData.gyms) {\r\n    item.marker = updateGymMarker(item, mapData.gyms[item['gym_id']].marker)\r\n  } else { // add marker to map and item to dict\r\n    item.marker = setupGymMarker(item)\r\n  }\r\n  mapData.gyms[item['gym_id']] = item\r\n}\r\n\r\nfunction processScanned (i, item) {\r\n  if (!Store.get('showScanned')) {\r\n    return false\r\n  }\r\n\r\n  var scanId = item['latitude'] + '|' + item['longitude']\r\n\r\n  if (scanId in mapData.scanned) {\r\n    mapData.scanned[scanId].marker.setOptions({\r\n      fillColor: getColorByDate(item['last_modified'])\r\n    })\r\n  } else { // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupScannedMarker(item)\r\n    mapData.scanned[scanId] = item\r\n  }\r\n}\r\n\r\nfunction processSpawnpoints (i, item) {\r\n  if (!Store.get('showSpawnpoints')) {\r\n    return false\r\n  }\r\n\r\n  var id = item['spawnpoint_id']\r\n  var zoom = map.getZoom()\r\n\r\n  if (id in mapData.spawnpoints) {\r\n    var hue = getColorBySpawnTime(item['time'])\r\n    mapData.spawnpoints[id].marker.setIcon(changeSpawnIcon(hue, zoom))\r\n    mapData.spawnpoints[id].marker.setZIndex(spawnPointIndex(hue))\r\n  } else { // add marker to map and item to dict\r\n    if (item.marker) {\r\n      item.marker.setMap(null)\r\n    }\r\n    item.marker = setupSpawnpointMarker(item)\r\n    mapData.spawnpoints[id] = item\r\n  }\r\n}\r\n\r\nfunction updateMap () {\r\n  loadRawData().done(function (result) {\r\n    $.each(result.pokemons, processPokemons)\r\n    $.each(result.pokestops, processPokestops)\r\n    $.each(result.gyms, processGyms)\r\n    $.each(result.scanned, processScanned)\r\n    $.each(result.spawnpoints, processSpawnpoints)\r\n    showInBoundsMarkers(mapData.pokemons, 'pokemon')\r\n    showInBoundsMarkers(mapData.lurePokemons, 'pokemon')\r\n    showInBoundsMarkers(mapData.gyms, 'gym')\r\n    showInBoundsMarkers(mapData.pokestops, 'pokestop')\r\n    showInBoundsMarkers(mapData.scanned, 'scanned')\r\n    showInBoundsMarkers(mapData.spawnpoints, 'inbound')\r\n//    drawScanPath(result.scanned);\r\n    clearStaleMarkers()\r\n    if ($('#stats').hasClass('visible')) {\r\n      countMarkers()\r\n    }\r\n  })\r\n}\r\n\r\nfunction drawScanPath (points) { // eslint-disable-line no-unused-vars\r\n  var scanPathPoints = []\r\n  $.each(points, function (idx, point) {\r\n    scanPathPoints.push({lat: point['latitude'], lng: point['longitude']})\r\n  })\r\n  if (scanPath) {\r\n    scanPath.setMap(null)\r\n  }\r\n  scanPath = new google.maps.Polyline({\r\n    path: scanPathPoints,\r\n    geodesic: true,\r\n    strokeColor: '#FF0000',\r\n    strokeOpacity: 1.0,\r\n    strokeWeight: 2,\r\n    map: map\r\n  })\r\n}\r\n\r\nfunction redrawPokemon (pokemonList) {\r\n  var skipNotification = true\r\n  $.each(pokemonList, function (key, value) {\r\n    var item = pokemonList[key]\r\n    if (!item.hidden) {\r\n      if (item.marker.rangeCircle) item.marker.rangeCircle.setMap(null)\r\n      var newMarker = setupPokemonMarker(item, map, this.marker.animationDisabled)\r\n      customizePokemonMarker(newMarker, item, skipNotification)\r\n      item.marker.setMap(null)\r\n      pokemonList[key].marker = newMarker\r\n    }\r\n  })\r\n}\r\n\r\nvar updateLabelDiffTime = function () {\r\n  $('.label-countdown').each(function (index, element) {\r\n    var disappearsAt = new Date(parseInt(element.getAttribute('disappears-at')))\r\n    var now = new Date()\r\n\r\n    var difference = Math.abs(disappearsAt - now)\r\n    var hours = Math.floor(difference / 36e5)\r\n    var minutes = Math.floor((difference - (hours * 36e5)) / 6e4)\r\n    var seconds = Math.floor((difference - (hours * 36e5) - (minutes * 6e4)) / 1e3)\r\n    var timestring = ''\r\n\r\n    if (disappearsAt < now) {\r\n      timestring = '(expired)'\r\n    } else {\r\n      timestring = '('\r\n      if (hours > 0) {\r\n        timestring = hours + 'h'\r\n      }\r\n\r\n      timestring += ('0' + minutes).slice(-2) + 'm'\r\n      timestring += ('0' + seconds).slice(-2) + 's'\r\n      timestring += ')'\r\n    }\r\n\r\n    $(element).text(timestring)\r\n  })\r\n}\r\n\r\nfunction getPointDistance (pointA, pointB) {\r\n  return google.maps.geometry.spherical.computeDistanceBetween(pointA, pointB)\r\n}\r\n\r\nfunction sendNotification (title, text, icon, lat, lng) {\r\n  if (!('Notification' in window)) {\r\n    return false // Notifications are not present in browser\r\n  }\r\n\r\n  if (Notification.permission !== 'granted') {\r\n    Notification.requestPermission()\r\n  } else {\r\n    var notification = new Notification(title, {\r\n      icon: icon,\r\n      body: text,\r\n      sound: 'sounds/ding.mp3'\r\n    })\r\n\r\n    notification.onclick = function () {\r\n      window.focus()\r\n      notification.close()\r\n\r\n      centerMap(lat, lng, 20)\r\n    }\r\n  }\r\n}\r\n\r\nfunction createMyLocationButton () {\r\n  var locationContainer = document.createElement('div')\r\n\r\n  var locationButton = document.createElement('button')\r\n  locationButton.style.backgroundColor = '#fff'\r\n  locationButton.style.border = 'none'\r\n  locationButton.style.outline = 'none'\r\n  locationButton.style.width = '28px'\r\n  locationButton.style.height = '28px'\r\n  locationButton.style.borderRadius = '2px'\r\n  locationButton.style.boxShadow = '0 1px 4px rgba(0,0,0,0.3)'\r\n  locationButton.style.cursor = 'pointer'\r\n  locationButton.style.marginRight = '10px'\r\n  locationButton.style.padding = '0px'\r\n  locationButton.title = 'My Location'\r\n  locationContainer.appendChild(locationButton)\r\n\r\n  var locationIcon = document.createElement('div')\r\n  locationIcon.style.margin = '5px'\r\n  locationIcon.style.width = '18px'\r\n  locationIcon.style.height = '18px'\r\n  locationIcon.style.backgroundImage = 'url(static/mylocation-sprite-1x.png)'\r\n  locationIcon.style.backgroundSize = '180px 18px'\r\n  locationIcon.style.backgroundPosition = '0px 0px'\r\n  locationIcon.style.backgroundRepeat = 'no-repeat'\r\n  locationIcon.id = 'current-location'\r\n  locationButton.appendChild(locationIcon)\r\n\r\n  locationButton.addEventListener('click', function () {\r\n    centerMapOnLocation()\r\n  })\r\n\r\n  locationContainer.index = 1\r\n  map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(locationContainer)\r\n\r\n  google.maps.event.addListener(map, 'dragend', function () {\r\n    var currentLocation = document.getElementById('current-location')\r\n    currentLocation.style.backgroundPosition = '0px 0px'\r\n  })\r\n}\r\n\r\nfunction centerMapOnLocation () {\r\n  var currentLocation = document.getElementById('current-location')\r\n  var imgX = '0'\r\n  var animationInterval = setInterval(function () {\r\n    if (imgX === '-18') {\r\n      imgX = '0'\r\n    } else {\r\n      imgX = '-18'\r\n    }\r\n    currentLocation.style.backgroundPosition = imgX + 'px 0'\r\n  }, 500)\r\n  if (navigator.geolocation) {\r\n    navigator.geolocation.getCurrentPosition(function (position) {\r\n      var latlng = new google.maps.LatLng(position.coords.latitude, position.coords.longitude)\r\n      locationMarker.setPosition(latlng)\r\n      map.setCenter(latlng)\r\n      Store.set('followMyLocationPosition', { lat: position.coords.latitude, lng: position.coords.longitude })\r\n      clearInterval(animationInterval)\r\n      currentLocation.style.backgroundPosition = '-144px 0px'\r\n    })\r\n  } else {\r\n    clearInterval(animationInterval)\r\n    currentLocation.style.backgroundPosition = '0px 0px'\r\n  }\r\n}\r\n\r\nfunction changeLocation (lat, lng) {\r\n  var loc = new google.maps.LatLng(lat, lng)\r\n  changeSearchLocation(lat, lng).done(function () {\r\n    map.setCenter(loc)\r\n    searchMarker.setPosition(loc)\r\n  })\r\n}\r\n\r\nfunction changeSearchLocation (lat, lng) {\r\n  return $.post('next_loc?lat=' + lat + '&lon=' + lng, {})\r\n}\r\n\r\nfunction centerMap (lat, lng, zoom) {\r\n  var loc = new google.maps.LatLng(lat, lng)\r\n\r\n  map.setCenter(loc)\r\n\r\n  if (zoom) {\r\n    storeZoom = false\r\n    map.setZoom(zoom)\r\n  }\r\n}\r\n\r\nfunction i8ln (word) {\r\n  if ($.isEmptyObject(i8lnDictionary) && language !== 'en' && languageLookups < languageLookupThreshold) {\r\n    $.ajax({\r\n      url: 'static/dist/locales/' + language + '.min.json',\r\n      dataType: 'json',\r\n      async: false,\r\n      success: function (data) {\r\n        i8lnDictionary = data\r\n      },\r\n      error: function (jqXHR, status, error) {\r\n        console.log('Error loading i8ln dictionary: ' + error)\r\n        languageLookups++\r\n      }\r\n    })\r\n  }\r\n  if (word in i8lnDictionary) {\r\n    return i8lnDictionary[word]\r\n  } else {\r\n    // Word doesn't exist in dictionary return it as is\r\n    return word\r\n  }\r\n}\r\n\r\n//\r\n// Page Ready Exection\r\n//\r\n\r\n$(function () {\r\n  if (!Notification) {\r\n    console.log('could not load notifications')\r\n    return\r\n  }\r\n\r\n  if (Notification.permission !== 'granted') {\r\n    Notification.requestPermission()\r\n  }\r\n})\r\n\r\n$(function () {\r\n  // populate Navbar Style menu\r\n  $selectStyle = $('#map-style')\r\n\r\n  // Load Stylenames, translate entries, and populate lists\r\n  $.getJSON('static/dist/data/mapstyle.min.json').done(function (data) {\r\n    var styleList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      styleList.push({\r\n        id: key,\r\n        text: i8ln(value)\r\n      })\r\n    })\r\n\r\n    // setup the stylelist\r\n    $selectStyle.select2({\r\n      placeholder: 'Select Style',\r\n      data: styleList,\r\n      minimumResultsForSearch: Infinity\r\n    })\r\n\r\n    // setup the list change behavior\r\n    $selectStyle.on('change', function (e) {\r\n      selectedStyle = $selectStyle.val()\r\n      map.setMapTypeId(selectedStyle)\r\n      Store.set('map_style', selectedStyle)\r\n    })\r\n\r\n    // recall saved mapstyle\r\n    $selectStyle.val(Store.get('map_style')).trigger('change')\r\n  })\r\n\r\n  $selectIconResolution = $('#pokemon-icons')\r\n\r\n  $selectIconResolution.select2({\r\n    placeholder: 'Select Icon Resolution',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectIconResolution.on('change', function () {\r\n    Store.set('pokemonIcons', this.value)\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  $selectIconSize = $('#pokemon-icon-size')\r\n\r\n  $selectIconSize.select2({\r\n    placeholder: 'Select Icon Size',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectIconSize.on('change', function () {\r\n    Store.set('iconSizeModifier', this.value)\r\n    redrawPokemon(mapData.pokemons)\r\n    redrawPokemon(mapData.lurePokemons)\r\n  })\r\n\r\n  $selectLuredPokestopsOnly = $('#lured-pokestops-only-switch')\r\n\r\n  $selectLuredPokestopsOnly.select2({\r\n    placeholder: 'Only Show Lured Pokestops',\r\n    minimumResultsForSearch: Infinity\r\n  })\r\n\r\n  $selectLuredPokestopsOnly.on('change', function () {\r\n    Store.set('showLuredPokestopsOnly', this.value)\r\n    updateMap()\r\n  })\r\n\r\n  $selectSearchIconMarker = $('#iconmarker-style')\r\n  $selectLocationIconMarker = $('#locationmarker-style')\r\n\r\n  $.getJSON('static/dist/data/searchmarkerstyle.min.json').done(function (data) {\r\n    searchMarkerStyles = data\r\n    var searchMarkerStyleList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      searchMarkerStyleList.push({\r\n        id: key,\r\n        text: value.name\r\n      })\r\n    })\r\n\r\n    $selectSearchIconMarker.select2({\r\n      placeholder: 'Select Icon Marker',\r\n      data: searchMarkerStyleList,\r\n      minimumResultsForSearch: Infinity\r\n    })\r\n\r\n    $selectSearchIconMarker.on('change', function (e) {\r\n      var selectSearchIconMarker = $selectSearchIconMarker.val()\r\n      Store.set('searchMarkerStyle', selectSearchIconMarker)\r\n      updateSearchMarker(selectSearchIconMarker)\r\n    })\r\n\r\n    $selectSearchIconMarker.val(Store.get('searchMarkerStyle')).trigger('change')\r\n\r\n    updateSearchMarker(Store.get('lockMarker'))\r\n\r\n    $selectLocationIconMarker.select2({\r\n      placeholder: 'Select Location Marker',\r\n      data: searchMarkerStyleList,\r\n      minimumResultsForSearch: Infinity\r\n    })\r\n\r\n    $selectLocationIconMarker.on('change', function (e) {\r\n      Store.set('locationMarkerStyle', this.value)\r\n      updateLocationMarker(this.value)\r\n    })\r\n\r\n    $selectLocationIconMarker.val(Store.get('locationMarkerStyle')).trigger('change')\r\n  })\r\n})\r\n\r\n$(function () {\r\n  function formatState (state) {\r\n    if (!state.id) {\r\n      return state.text\r\n    }\r\n    var $state = $(\r\n      '<span><i class=\"pokemon-sprite n' + state.element.value.toString() + '\"></i> ' + state.text + '</span>'\r\n    )\r\n    return $state\r\n  }\r\n\r\n  if (Store.get('startAtUserLocation')) {\r\n    centerMapOnLocation()\r\n  }\r\n\r\n  $.getJSON('static/dist/data/moves.min.json').done(function (data) {\r\n    moves = data\r\n  })\r\n\r\n  $selectExclude = $('#exclude-pokemon')\r\n  $selectPokemonNotify = $('#notify-pokemon')\r\n  $selectRarityNotify = $('#notify-rarity')\r\n  var numberOfPokemon = 151\r\n\r\n  // Load pokemon names and populate lists\r\n  $.getJSON('static/dist/data/pokemon.min.json').done(function (data) {\r\n    var pokeList = []\r\n\r\n    $.each(data, function (key, value) {\r\n      if (key > numberOfPokemon) {\r\n        return false\r\n      }\r\n      var _types = []\r\n      pokeList.push({\r\n        id: key,\r\n        text: i8ln(value['name']) + ' - #' + key\r\n      })\r\n      value['name'] = i8ln(value['name'])\r\n      value['rarity'] = i8ln(value['rarity'])\r\n      $.each(value['types'], function (key, pokemonType) {\r\n        _types.push({\r\n          'type': i8ln(pokemonType['type']),\r\n          'color': pokemonType['color']\r\n        })\r\n      })\r\n      value['types'] = _types\r\n      idToPokemon[key] = value\r\n    })\r\n\r\n    // setup the filter lists\r\n    $selectExclude.select2({\r\n      placeholder: i8ln('Select Pokémon'),\r\n      data: pokeList,\r\n      templateResult: formatState\r\n    })\r\n    $selectPokemonNotify.select2({\r\n      placeholder: i8ln('Select Pokémon'),\r\n      data: pokeList,\r\n      templateResult: formatState\r\n    })\r\n    $selectRarityNotify.select2({\r\n      placeholder: i8ln('Select Rarity'),\r\n      data: [i8ln('Common'), i8ln('Uncommon'), i8ln('Rare'), i8ln('Very Rare'), i8ln('Ultra Rare')],\r\n      templateResult: formatState\r\n    })\r\n\r\n    // setup list change behavior now that we have the list to work from\r\n    $selectExclude.on('change', function (e) {\r\n      excludedPokemon = $selectExclude.val().map(Number)\r\n      clearStaleMarkers()\r\n      Store.set('remember_select_exclude', excludedPokemon)\r\n    })\r\n    $selectPokemonNotify.on('change', function (e) {\r\n      notifiedPokemon = $selectPokemonNotify.val().map(Number)\r\n      Store.set('remember_select_notify', notifiedPokemon)\r\n    })\r\n    $selectRarityNotify.on('change', function (e) {\r\n      notifiedRarity = $selectRarityNotify.val().map(String)\r\n      Store.set('remember_select_rarity_notify', notifiedRarity)\r\n    })\r\n\r\n    // recall saved lists\r\n    $selectExclude.val(Store.get('remember_select_exclude')).trigger('change')\r\n    $selectPokemonNotify.val(Store.get('remember_select_notify')).trigger('change')\r\n    $selectRarityNotify.val(Store.get('remember_select_rarity_notify')).trigger('change')\r\n\r\n    if (isTouchDevice()) {\r\n      $('.select2-search input').prop('readonly', true)\r\n    }\r\n  })\r\n\r\n  // run interval timers to regularly update map and timediffs\r\n  window.setInterval(updateLabelDiffTime, 1000)\r\n  window.setInterval(updateMap, 5000)\r\n  window.setInterval(function () {\r\n    if (navigator.geolocation && (Store.get('geoLocate') || Store.get('followMyLocation'))) {\r\n      navigator.geolocation.getCurrentPosition(function (position) {\r\n        var lat = position.coords.latitude\r\n        var lng = position.coords.longitude\r\n        var center = new google.maps.LatLng(lat, lng)\r\n\r\n        if (Store.get('geoLocate')) {\r\n          // the search function makes any small movements cause a loop. Need to increase resolution\r\n          if ((typeof searchMarker !== 'undefined') && (getPointDistance(searchMarker.getPosition(), center) > 40)) {\r\n            $.post('next_loc?lat=' + lat + '&lon=' + lng).done(function () {\r\n              map.panTo(center)\r\n              searchMarker.setPosition(center)\r\n            })\r\n          }\r\n        }\r\n        if (Store.get('followMyLocation')) {\r\n          if ((typeof locationMarker !== 'undefined') && (getPointDistance(locationMarker.getPosition(), center) >= 5)) {\r\n            map.panTo(center)\r\n            locationMarker.setPosition(center)\r\n            Store.set('followMyLocationPosition', { lat: lat, lng: lng })\r\n          }\r\n        }\r\n      })\r\n    }\r\n  }, 1000)\r\n\r\n  // Wipe off/restore map icons when switches are toggled\r\n  function buildSwitchChangeListener (data, dataType, storageKey) {\r\n    return function () {\r\n      Store.set(storageKey, this.checked)\r\n      if (this.checked) {\r\n        updateMap()\r\n      } else {\r\n        $.each(dataType, function (d, dType) {\r\n          $.each(data[dType], function (key, value) {\r\n            // for any marker you're turning off, you'll want to wipe off the range\r\n            if (data[dType][key].marker.rangeCircle) {\r\n              data[dType][key].marker.rangeCircle.setMap(null)\r\n              delete data[dType][key].marker.rangeCircle\r\n            }\r\n            if (storageKey !== 'showRanges') data[dType][key].marker.setMap(null)\r\n          })\r\n          if (storageKey !== 'showRanges') data[dType] = {}\r\n        })\r\n        if (storageKey === 'showRanges') {\r\n          updateMap()\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  // Setup UI element interactions\r\n  $('#gyms-switch').change(buildSwitchChangeListener(mapData, ['gyms'], 'showGyms'))\r\n  $('#pokemon-switch').change(buildSwitchChangeListener(mapData, ['pokemons'], 'showPokemon'))\r\n  $('#scanned-switch').change(buildSwitchChangeListener(mapData, ['scanned'], 'showScanned'))\r\n  $('#spawnpoints-switch').change(buildSwitchChangeListener(mapData, ['spawnpoints'], 'showSpawnpoints'))\r\n  $('#ranges-switch').change(buildSwitchChangeListener(mapData, ['gyms', 'pokemons', 'pokestops'], 'showRanges'))\r\n\r\n  $('#pokestops-switch').change(function () {\r\n    var options = {\r\n      'duration': 500\r\n    }\r\n    var wrapper = $('#lured-pokestops-only-wrapper')\r\n    if (this.checked) {\r\n      wrapper.show(options)\r\n    } else {\r\n      wrapper.hide(options)\r\n    }\r\n    return buildSwitchChangeListener(mapData, ['pokestops'], 'showPokestops').bind(this)()\r\n  })\r\n\r\n  $('#sound-switch').change(function () {\r\n    Store.set('playSound', this.checked)\r\n  })\r\n\r\n  $('#geoloc-switch').change(function () {\r\n    $('#next-location').prop('disabled', this.checked)\r\n    $('#next-location').css('background-color', this.checked ? '#e0e0e0' : '#ffffff')\r\n    if (!navigator.geolocation) {\r\n      this.checked = false\r\n    } else {\r\n      Store.set('geoLocate', this.checked)\r\n    }\r\n  })\r\n\r\n  $('#lock-marker-switch').change(function () {\r\n    Store.set('lockMarker', this.checked)\r\n    searchMarker.setDraggable(!this.checked)\r\n  })\r\n\r\n  $('#search-switch').change(function () {\r\n    searchControl(this.checked ? 'on' : 'off')\r\n  })\r\n\r\n  $('#start-at-user-location-switch').change(function () {\r\n    Store.set('startAtUserLocation', this.checked)\r\n  })\r\n\r\n  $('#follow-my-location-switch').change(function () {\r\n    if (!navigator.geolocation) {\r\n      this.checked = false\r\n    } else {\r\n      Store.set('followMyLocation', this.checked)\r\n    }\r\n    locationMarker.setDraggable(!this.checked)\r\n  })\r\n\r\n  if ($('#nav-accordion').length) {\r\n    $('#nav-accordion').accordion({\r\n      active: 0,\r\n      collapsible: true,\r\n      heightStyle: 'content'\r\n    })\r\n  }\r\n})\r\n"]}